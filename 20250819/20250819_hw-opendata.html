<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hw-opendata</title>
    <!-- 載入bs5 css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.7/css/bootstrap.min.css"
        integrity="sha512-fw7f+TcMjTb7bpbLJZlP8g2Y4XcCyFZW8uy8HsRZsH/SwbMw0plKHFHr99DN3l04VsYNwvzicUX/6qurvIxbxw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* chatGPT幫我美化的 */
        body {
            background-color: #fff8f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
        }

        h2,
        h4 {
            color: #cc7a00;
        }

        .form-check-input:checked {
            background-color: #f0a500;
            border-color: #f0a500;
        }

        .form-check-label {
            cursor: pointer;
        }

        .btn-info {
            background-color: #f0a500;
            border: none;
            color: #fff;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .btn-info:hover {
            background-color: #e68a00;
        }

        .table {
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
        }

        .table th {
            background-color: #ffe5b4;
            color: #804000;
        }

        .table td {
            background-color: #fffaf0;
        }

        .form-check {
            padding: 5px 0;
        }

        .row.mt-3 {
            flex-wrap: wrap;
        }

        .row.mt-3 .col-1 {
            flex: 0 0 10%;
            max-width: 10%;
        }

        @media (max-width: 768px) {
            .row.mt-3 .col-1 {
                flex: 0 0 50%;
                max-width: 50%;
            }
        }

        hr {
            border: 1px solid #f0a500;
        }
    </style>

</head>

<body>
    <!-- 自己找資料串 -->
    <div class="container mt-3 ">
        <h2 class="text-center">空氣品質指標</h2>
        <h4>縣市篩選</h4>
        <form id="myForm">
            <div class="row mt-3">
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check1" name="myCheck[]" value="基隆市"
                            checked>
                        <label class="form-check-label" for="check1">基隆市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check2" name="myCheck[]" value="新北市">
                        <label class="form-check-label" for="check2">新北市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check3" name="myCheck[]" value="臺北市">
                        <label class="form-check-label" for="check3">臺北市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check4" name="myCheck[]" value="桃園市">
                        <label class="form-check-label" for="check4">桃園市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check5" name="myCheck[]" value="新竹縣">
                        <label class="form-check-label" for="check5">新竹縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check6" name="myCheck[]" value="新竹市">
                        <label class="form-check-label" for="check6">新竹市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check7" name="myCheck[]" value="苗栗縣">
                        <label class="form-check-label" for="check7">苗栗縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check8" name="myCheck[]" value="臺中市">
                        <label class="form-check-label" for="check8">臺中市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check9" name="myCheck[]" value="彰化縣">
                        <label class="form-check-label" for="check9">彰化縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check10" name="myCheck[]" value="南投縣">
                        <label class="form-check-label" for="check10">南投縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check11" name="myCheck[]" value="雲林縣">
                        <label class="form-check-label" for="check11">雲林縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check12" name="myCheck[]" value="嘉義縣">
                        <label class="form-check-label" for="check12">嘉義縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check13" name="myCheck[]" value="嘉義市">
                        <label class="form-check-label" for="check13">嘉義市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check14" name="myCheck[]" value="臺南市">
                        <label class="form-check-label" for="check14">臺南市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check15" name="myCheck[]" value="高雄市">
                        <label class="form-check-label" for="check15">高雄市</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check15" name="myCheck[]" value="屏東縣">
                        <label class="form-check-label" for="check16">屏東縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check17" name="myCheck[]" value="臺東縣">
                        <label class="form-check-label" for="check17">臺東縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check18" name="myCheck[]" value="花蓮縣">
                        <label class="form-check-label" for="check18">花蓮縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check19" name="myCheck[]" value="宜蘭縣">
                        <label class="form-check-label" for="check19">宜蘭縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check20" name="myCheck[]" value="連江縣">
                        <label class="form-check-label" for="check20">連江縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check21" name="myCheck[]" value="金門縣">
                        <label class="form-check-label" for="check21">金門縣</label>
                    </div>
                </div>
                <div class="col-1">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="check22" name="myCheck[]" value="澎湖縣">
                        <label class="form-check-label" for="check22">澎湖縣</label>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="d-grid">
                    <button type="submit" class="btn btn-info btn-block">篩選</button>
                </div>
            </div>
        </form>
    </div>


    <div class="container mt-3">
        <hr>
        <h4>資料顯示</h4>
        <table class="table table-bordered text-center table-hover">
            <thead>
                <tr>
                    <th>id</th>
                    <th>測站名稱(sitename)</th>
                    <th>縣市(county)</th>
                    <th>空氣品質指標(aqi)</th>
                    <th>狀態(status)</th>
                </tr>
            </thead>
            <tbody id="myTbody">
                <!-- <tr>
                    <td>1</td>
                    <td>台北市</td>
                    <td>24-34</td>
                    <td>25-35</td>
                    <td>26-36</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>台北市</td>
                    <td>24-34</td>
                    <td>25-35</td>
                    <td>26-36</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>台北市</td>
                    <td>24-34</td>
                    <td>25-35</td>
                    <td>26-36</td>
                </tr> -->
            </tbody>
        </table>
    </div>

    <!-- 載入bs5 bundle js (有bundle才是完整版) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.7/js/bootstrap.bundle.min.js"
        integrity="sha512-Tc0i+vRogmX4NN7tuLbQfBxa8JkfUSAxSFVzmU31nVdHyiHElPPy2cWfFacmCJKw0VqovrzKhdd2TSTMdAxp2g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- 載入jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer">
        </script>

    <script>
        $(document).ready(function () {
            // 1.bind
            const myTbody = $("#myTbody");
            const myForm = $("#myForm");



            // 2.action
            let url = "./data/aqiData.json";
            let data = [];
            $.ajax({
                type: "get",
                url: url,
                // data: "data",
                dataType: "json",
                success: function (response) {
                    // console.log('response',response);
                    data = response;
                    // console.log('data',data);

                    // let siteName = data.records[1].sitename;
                    // console.log('siteName',siteName);

                    let content = ``;
                    $.each(data.records, function (key, value) {
                        // console.log('key',key);
                        // console.log('value',value);
                        // console.log('value.sitename',value.sitename);
                        content += `
                            <tr>
                                <td>${key + 1}</td>
                                <td>${value.sitename}</td>
                                <td>${value.county}</td>
                                <td>${value.aqi}</td>
                                <td>${value.status}</td>
                            </tr>
                        `;

                    });
                    myTbody.append(content);

                }
            });


            // 篩選 start
            myForm.submit(function (e) {
                e.preventDefault();
                // 清空table
                myTbody.html('');

                // 抓form data
                let formData = myForm.serializeArray();
                // console.log("formData", formData);

                let locationArr = []; // 我勾選的資料
                $.each(formData, function (key, value) {
                    // console.log("value", value);
                    locationArr.push(value.value);

                });
                // console.log("locationArr", locationArr);


                // show data to table
                content = ``;
                $.each(data.records, function (key, value) {
                    // console.log('key', key);
                    // console.log('value', value);
                    // console.log('value.county',value.county);

                    let tmpCounty = value.county;
                    let index = locationArr.indexOf(tmpCounty);
                    // console.log('tmpCounty', tmpCounty);
                    // console.log('index', index);

                    // 不存在 index=-1 , 存在 index>=0
                    if (index >= 0) {
                        content += `
                            <tr>
                                <td>${key + 1}</td>
                                <td>${value.sitename}</td>
                                <td>${value.county}</td>
                                <td>${value.aqi}</td>
                                <td>${value.status}</td>
                            </tr>
                        `;
                    }
                });
                myTbody.append(content);
            });
            // 篩選 end
        });
    </script>
</body>

</html>